"use strict";class Seule{constructor(e){this.child=!1,this.data=e.data||{};let t="",n=()=>this.Init(),i=(e,t)=>{let i=this.child;class r{constructor(e){if(!e)return new r(i);try{this.el=t?document.querySelectorAll(e):i.querySelectorAll(e)}catch(t){e.length?this.el=e:this.el=[e]}}$(){return new r(i)}Select(e){return new r(this.el[0].querySelectorAll(e))}Element(e){return new r(this.el[e])}Dom(e){return e||0===e?this.el[e]:this.el}Parent(e){if(!e)return new r(this.el[0].parentElement);new r(e.el?e.Dom(0):i.querySelector(e)).Append(this)}Child(){let e={};return e.first=(()=>new r(this.el[0].children[0])),e.last=(()=>new r(this.el[0].children[this.el[0].children.length-1])),e.number=(e=>new r(this.el[0].children[e])),e.all=(()=>new r(this.el[0].children)),e}Move(){let e={};return e.after=(e=>{const t=new r(e.el?e.Dom():e);return t.Parent().Dom(0).insertBefore(this.el[0],t.Dom(0).nextSibling),this}),e.before=(e=>{const t=new r(e.el?e.Dom():e);return t.Parent().Dom(0).insertBefore(this.el[0],t.Dom(0)),this}),e}Append(e){const t=new r(e.el?e.Dom():e);return this.Each(function(){for(const e of t.Dom())this.appendChild(e)})}Remove(){return this.Each(function(){this.parentNode.removeChild(this)})}Duplicate(){let e,t,n,i=[];return this.Each(function(){e=new r(this),n=e.GetEvents(),t=this.cloneNode(!0);for(const e of n)t.addEventListener(e.type,e.listener);i.push(t)}),new r(i)}Replace(e){const t=new r(e.el?e.Dom():e);for(const e of t.Dom()){let t=this.el[0].cloneNode(!0);e.parentNode.replaceChild(t,e)}return this}Create(e){return new r(document.createElement(e))}Each(e){for(const t of this.el)e.call(t,new r(t));return this}Load(e,t=0){return this.Each(function(n){setTimeout(()=>{e(new r(this))},t)})}Loop(e,t=1e3){return this.Each(function(n){let i={stop:e=>(function(e){clearInterval(s),e&&e(i.el)})(e),counter:0,el:new r(this)},s=setInterval(()=>{e(i),i.counter++},t)})}On(e,t,i){if("hold"!==e)return this.Each(function(){t&&this.addEventListener(e,()=>{t(new r(this),this),i&&n()},!1)});this.Hold(t)}Click(e,t){return e?this.On("click",t=>e(t),t):this.Fire("click"),this}Hold(e,t=1500){return this.Each(function(){let n=!1,i="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,s=i?"touchstart":"mousedown",o=i?"touchend":"mouseup";this.addEventListener(s,i=>{n=!0,setTimeout(function(){n&&e(new r(i),i)},t)}),this.addEventListener(o,()=>n=!1)})}Focus(e,t){return e?this.On("focus",t=>e(t),t):this.Fire("focus"),this}Blur(e,t){return e?this.On("blur",t=>e(t),t):this.Fire("blur"),this}Swipe(e,t){let n,i,s=this.el;for(let e of s)e.addEventListener("touchstart",o,!1),e.addEventListener("touchmove",l,!1);function o(e){n=e.touches[0].clientX,i=e.touches[0].clientY}function l(s){if(!n||!i)return;let o=s.touches[0].clientX,l=s.touches[0].clientY,c=n-o,a=i-l;Math.abs(c)>Math.abs(a)?(c>10&&"left"===e&&t(new r(this)),c<-10&&"right"===e&&t(new r(this))):(a>10&&"top"===e&&t(new r(this)),a<-10&&"bottom"===e&&t(new r(this))),n=null,i=null}return this}HotKey(e,t,n){let i,s="",o={Arrow:"",Control:"ctrl"},l=e.replace(/\s/g,"");return this.Each(function(){this.addEventListener("keydown",function(e){n&&e.preventDefault(),s=(s=(s+=e.key).replace(/Arrow|Control/gi,function(e){return o[e]})).replace(/ /g,"space"),(i=s.toLowerCase().indexOf(l.toLowerCase()))>-1&&(t&&t(new r(this)),this.focus(),s="")},!0)})}Fire(e){return this.Each(function(){e&&this[e]()})}Copy(e,t){let n,r=t.split(":");n="string"==typeof e?i.querySelector(e):e;for(let e of r)this.On(e.trimStart().trimEnd(),function(){let t=new MouseEvent(e.trimStart().trimEnd(),{view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(t)});return this}Toggle(e,t,n){let i=!0;return this.On(e,function(e){if(i)return t.handler&&t.handler(e),void(i=!1);t.callback&&t.callback(e),i=!0},n),this}GetEvents(e){let t=[];for(const n of Object.values(this.el[0].getEventListeners(e)))e?t.push(n):t.push(n[0]);return t}Visible(){let e={};return e.showing=(()=>{for(let e of this.el)e.style.visibility="visible";return this}),e.hidden=(()=>{for(let e of this.el)e.style.visibility="hidden";return this}),e.status=(()=>"hidden"!==this.el[0].style.visibility),e}Show(){return this.Each(function(){let e=this.getAttribute("style");e&&e.replace(/\s/g,"").includes("display:none")&&(this.style.display=""),"none"===getComputedStyle(this).display&&(this.style.display="initial")})}Hide(){return this.Each(function(){this.style.display="none"})}Opacity(e){return e?this.Each(function(){this.style.opacity=e}):this.el[0].style.opacity}Classes(e){let t={},n=t=>{for(const n of this.el)n.classList[t](e)},i=["add","remove","toggle"];t.list=[];for(const e of this.el[0].classList)t.list.push(e);t.contains=(()=>this.el[0].classList.contains(e));for(let e of i)t[e]=(()=>(n(e),this));return t}Css(e){let t={};return t.set=(t=>{if("object"==typeof e){let t=Object.keys(e),n={},i={},s={},o={},l={};for(const r of t){let t="duration property direction loop time delay text effect";"object"==typeof e[r]||t.includes(r)||(e[r]={value:e[r]});let c=e[r].delay,a=e[r].duration||e.duration||0;if(e[r].delay||(c=0),!t.includes(r)){let t=getComputedStyle(this.el[0]);n[r]=a+"ms "+c+"ms",i[r]=e[r].value||0,o===l&&(o[r]=t[r]||0),s[r]=parseFloat(c)+parseFloat(a)}}i.transition=r.objectToStyle(n).replace(/:/g," ").replace(/;/g,", "),i["transition-timing-function"]=e.effect||"ease",e.particularly&&(i["transition-property"]=e.particularly.value),e.loop||e.direction||(e.duration&&(i["transition-duration"]=e.duration+"ms"),e.delay&&(i["transition-delay"]=e.delay+"ms")),o.transition=i.transition,o["transition-timing-function"]=i["transition-timing-function"],e.property&&(o["transition-property"]=i["transition-property"]),e.duration&&(o["transition-duration"]=i["transition-duration"]),e.delay&&(o["transition-delay"]=i["transition-delay"]),o===l&&(l=o);let c=Object.values(s);return s=Math.max(...c),this.Each(function(){let t,n=this,l=1,c=100;(e.loop||e.direction)&&e.delay&&(c=e.delay);let a=2*parseInt(s+c)+100;function h(e,s){n.setAttribute("style",r.objectToStyle(i)),setTimeout(()=>n.setAttribute("style",r.objectToStyle(o)),parseInt(e)),s&&s<=++l&&clearInterval(t)}e.direction||e.loop?(h(s+c),t=setInterval(function(){e.time?h(s+c,e.time):h(s+c)},a),e.direction&&clearInterval(t)):n.setAttribute("style",r.objectToStyle(i))})}return this.Each(function(){this.style[e]=t})}),t.get=(()=>getComputedStyle(this.el[0])[e]),t}Style(e){return this.Each(function(){this.animate(e,{duration:0,fill:"forwards"})})}Anime(e){let t={};return this.Each(function(){t.animation=this.animate(e.keyframes,{delay:e.delay||0,duration:e.duration||700,fill:e.fill||"forwards",easing:e.effect||"ease-in-out",times:e.iterations||1})}),t.start=(()=>(t.animation.play(),this)),t.freeze=(()=>(t.animation.pause(),this)),t.stop=(()=>(t.animation.finish(),this)),t.cancel=(()=>(t.animation.cancel(),this)),t.animation.addEventListener("finish",()=>e.onfinish&&e.onfinish(this,t)),t.animation.addEventListener("cancel",()=>e.oncancel&&e.oncancel(this,t)),t}Width(e){return e?this.Each(function(){this.style.width=e}):getComputedStyle(this.el[0]).width}Height(e){return e?this.Each(function(){this.style.height=e}):getComputedStyle(this.el[0]).height}Attr(e){let t={};return t.set=(t=>{for(const n of this.el)n.setAttribute(e,t);return this}),t.remove=(()=>{for(const t of this.el)t.removeAttribute(e);return this}),t.get=(()=>this.el[0].getAttribute(e)),t.has=(()=>this.el[0].hasAttribute(e)),t}Text(e){return r.CONTENT("Text",e,this)}Html(e){return r.CONTENT("HTML",e,this)}Val(e){let t={};return t.set=(()=>{for(const t of this.el)t.value=e;return this}),t.get=(()=>this.el[0].value),t}ScrollPosition(e){return e?this.el[0].pageXOffset||this.el[0].scrollLeft:this.el[0].pageYOffset||this.el[0].scrollTop}Scroll(){const e=(e,n)=>{const i=e,r=n,s=i.scrollTop;let o=r.offsetTop-i.scrollTop;s<r.offsetTop&&r.offsetTop>i.scrollHeight-i.clientHeight&&(o=i.scrollHeight-i.clientHeight-i.scrollTop);let l=0;const c=Math.round(30);!function e(){i.scrollTop=t(l,s,o,c),++l<c&&requestAnimationFrame(e)}()},t=(e,t,n,i)=>n*(Math.pow(e/i-1,3)+1)+t;if("fixed"===getComputedStyle(this.el[0].parentElement).position)e(this.el[0].parentNode,this.el[0]);else{e(document.documentElement||document.body,this.el[0])}return this}static CONTENT(e,t,n){let i={get:()=>n.el[0]["inner"+e],set:()=>{for(let i of n.el)i["inner"+e]=t;return n},clear:()=>{for(let t of n.el)t["inner"+e]="";return n},append:i=>{let r=i||"beforeend";for(let i of n.el)i["insertAdjacent"+e](r,t);return n}};return i}static objectToStyle(e){return("'"+Object.keys(e).map(t=>t+": "+e[t]).join(";")+"'").slice(1).slice(0,-1)}}return new r(e)};this.Render=(e=>{let t=Object.keys(this.data),n=e||this.child.innerHTML;for(let e of t)for(;n.includes("{{"+e+"}}");)n=n.replace("{{"+e+"}}",this.data[e].replace(/<[^>]*>/g,""));this.child.innerHTML=n}),(()=>{let n=document.querySelector(e.el),i={},r=e.el.replace("#","").replace(".",""),s="";Element.prototype._addEventListener=Element.prototype.addEventListener,Element.prototype._removeEventListener=Element.prototype.removeEventListener,Element.prototype.addEventListener=function(e,t,n=!1){this._addEventListener(e,t,n),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]),this.eventListenerList[e].push({type:e,listener:t,useCapture:n})},Element.prototype.removeEventListener=function(e,t,n=!1){this._removeEventListener(e,t,n),this.eventListenerList||(this.eventListenerList={}),this.eventListenerList[e]||(this.eventListenerList[e]=[]);for(let i=0;i<this.eventListenerList[e].length;i++)if(this.eventListenerList[e][i].listener===t&&this.eventListenerList[e][i].useCapture===n){this.eventListenerList[e].splice(i,1);break}0===this.eventListenerList[e].length&&delete this.eventListenerList[e]},Element.prototype.getEventListeners=function(e){return this.eventListenerList||(this.eventListenerList={}),void 0===e?this.eventListenerList:this.eventListenerList[e]};customElements.define("seule-"+r,class extends HTMLElement{constructor(){super();const t=this.attachShadow({mode:"closed"});let i=firstEl.context.querySelectorAll("head link");if(e.style&&"root"===e.style)for(const e of i)if(e.getAttribute("about")&&e.getAttribute("about").includes("root")){const n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("href",e.getAttribute("href")),t.appendChild(n)}let r=n.cloneNode(!0);n.innerHTML="",t.appendChild(r),s=t.children[t.children.length-1],t.children[t.children.length-1].removeAttribute("id")}}),i=document.createElement("seule-"+r),n.appendChild(i),this.child=s,t=s.innerHTML})(),this.Component=((t,n)=>{let r=i(t);return n.data&&(n.data.length||(n.obj=[],n.obj.push(n.data),n.data=n.obj)),"string"==typeof n.style&&"parent"===n.style.toLowerCase()&&(n.style=[e.style]),Seule.PDO(n.data||[{}],{find:e=>(e=>i(e))(e),element:r,component:!0,mode:n.mode,style:n.style||"",execute:n.execute||!1,child:n.child||!1,columns:n.columns||!1,nest:n.nest||!1,item:n.item||!1,action:n.action||!1,selector:t,query:e=>n.query?n.query(e):e,template:e=>n.template(e)||"",handler(e,t,i){n.handler&&n.handler(e,t,i)}}),this}),e.root&&this.Root(),this.Render(),e.handler&&e.handler(this,e=>i(e),e=>i(e,!0)),this.Init=(()=>{this.Render(t),e.handler&&e.handler(this,e=>i(e),e=>i(e,!0))})}Root(){const e=new URL(window.location).searchParams.entries();for(let t of e)this.data[t[0]]=String(t[1]);return this.Render(),this}async Get(e,t){t||(t={});let n=this.child,i=new FormData;if(t.param={method:t.method||"get"},t.form){let e=n.querySelector(t.form)||document.querySelector(t.form);i=new FormData(e),e.onsubmit=(async e=>e.preventDefault())}if(t.file)if("object"==typeof t.file)for(const e of t.file){let t;t="object"==typeof e?e:n.querySelector(e),i.append(t.name,t.files[0])}else t.file=n.querySelector(t.file),i.append(t.file.name,t.file.files[0]);t.data&&Object.keys(t.data).forEach(e=>i.append(e,t.data[e])),"post"===t.method&&(t.param.body=i);let r=await fetch(e,t.param);return r.ok?t.blob?await r.blob():t.json?await r.json():await r.text():"HTTP-Error: "+r.status}async Post(e,t){return t.method="post",await this.Get(e,t)}static Store(e){let t={};return t.set=(t=>(window.localStorage.setItem(e,JSON.stringify(t)),this)),t.get=(()=>JSON.parse(window.localStorage.getItem(e))),t.remove=(()=>(window.localStorage.removeItem(e),this)),t.reset=(()=>(window.localStorage.clear(),this)),t}static Audio(e){let t={Delay:0};return t.Element=new Audio(e),t.Src=e,t.Play=function(e){return t.Delay=1e3*e,setTimeout(function(){t.Element.pause(),t.Element.play()},t.Delay),this},t.Stop=function(e){return setTimeout(function(){t.Element.pause(),t.Element.currentTime=0},1e3*e),this},t.Pause=function(e){return setTimeout(function(){t.Element.pause()},1e3*e),this},t}static Date(e){let t={Increase:function(n,i){let r=new Date(e),s=new Date(r.setMonth(r.getMonth()+parseInt(i))),o=s.getMonth()+1;if(n)if("day"===n.toLowerCase()){let n=new Date(e);n.setDate(n.getDate()+parseInt(i)),t.current=n.getFullYear()+"-"+("0"+(n.getMonth()+1)).slice(-2)+"-"+("0"+n.getDate()).slice(-2)}else o=r.getFullYear()+1,t.current=o+"-"+("0"+r.getMonth()).slice(-2)+"-"+("0"+r.getDate()).slice(-2);else t.current=s.getFullYear()+"-"+("0"+o).slice(-2)+"-"+("0"+s.getDate()).slice(-2);return t.res=t.current,this},BetWeen:function(e){let n=t.current||t.Increase("day",0).current,i=e.from.split(e.character||"-"),r=e.to.split(e.character||"-"),s=n.split(e.character||"-");return e.from=new Date(i[0],parseInt(i[1])-1,i[2]),e.to=new Date(r[0],parseInt(r[1])-1,r[2]),(n=new Date(s[0],parseInt(s[1])-1,s[2]))>e.from&&n<e.to?(e.handler&&e.handler(),t.res=!0,this):(e.callback&&e.callback(),t.res=!1,this)},Ar:()=>{let t=new Date(e);return["اﻷحد","اﻷثنين","الثلاثاء","اﻷربعاء","الخميس","الجمعة","السبت"][t.getDay()]+" "+t.getDate()+" "+["يناير","فبراير","مارس","إبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"][t.getMonth()]+" "+t.getFullYear()}};return t}static Scroll(){let e={};return e.top=(()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;return t>0&&(window.requestAnimationFrame(e.top),window.scrollTo(0,t-t/8)),this}),e.bottom=(()=>{const t=document.documentElement.scrollTop||document.body.scrollTop,n=document.body.scrollHeight;if(!(window.innerHeight+window.scrollY>=document.body.offsetHeight))return window.requestAnimationFrame(e.bottom),window.scrollTo(0,t+n/40),this;window.scrollTo(0,t+n/40)}),e.onBottom=((e,t=0)=>(window.onscroll=(n=>{window.innerHeight+window.scrollY>=document.body.offsetHeight-t&&e(this)}),this)),e.onTop=(e=>(window.onscroll=(t=>{window.scrollY<=0&&e(this)}),this)),e.position=(()=>window.screenTop),e}static Orientation(){return 90===screen.orientation.angle?"Horizontally":"Vertically"}static Screen(e,t){e.includes("(")||(e="("+e+")");let n=window.matchMedia(e),i=e=>(e.matches?t.handler&&t.handler():t.callback&&t.callback(),e),r=i(n);return n.addEventListener("change",i),r}static Print(e){let t=e.title||"";document.querySelector("body").insertAdjacentHTML("beforeend",'<iframe class="seule--frame" name="sframe" style="position: fixed; bottom: -100%"></iframe>');let n=document.getElementsByClassName("seule--frame")[0],i=n.contentWindow?n.contentWindow:n.contentDocument.document?n.contentDocument.document:n.contentDocument;i.document.open(),i.document.write("<html><head><title>"+t+"</title>"),i.document.write("</head><body>"),e.style&&i.document.write('<link href="'+e.style+'" rel="stylesheet" type="text/css" />'),i.document.write(e.template),i.document.write("</body></html>"),i.document.close(),setTimeout(function(){window.frames.sframe.focus(),window.frames.sframe.print()},500)}SceneHandler(e){let t=this.child;return window.addEventListener("scroll",function(){!function(e){let n;try{n=t.querySelector(e.selector)}catch(t){n=e.selector}let i,r=e.unit||"percent",s=e.distance,o=window.innerHeight||document.documentElement.clientHeight,l=n.getBoundingClientRect().top,c=Math.round(l/o*100),a=Math.round(l);(i="percent"===r?c:a)<=s?e.handler():e.callback&&e.callback()}(e)},!1),this}Scene(e){let t=0;return this.SceneHandler({selector:e.selector,distance:e.distance||0,unit:e.unit||"percent",handler:()=>{0===t&&(e.handler(),t=1)},callback:()=>{1===t&&e.callback&&(e.callback(),t=0)}}),this}static PDO(e,t){t&&(t.query||(t.query=(e=>e)));let n=[...e],i=[],r=[],s={};if(s.alter=((t,n,i)=>((i=i||e).map(function(e){let i=e;if("object"==typeof n&&"replace"===t.toLowerCase()&&(i[n[1]]=i[n[0]],delete i[n[0]]),"drop"===t.toLowerCase())for(const e of n)delete i[e];if("add"===t.toLowerCase())for(const e of n)i.hasOwnProperty(e)||(i[e]="");return i}),s)),s.group=((t,n)=>{n=n||e;let i=[],r=[...new Set(n.reduce((e,n)=>e.concat(n[t]),[]))];for(const e of r){let n='{"'+t+'":"'+e+'"}';i.push(JSON.parse(n))}return s.res=i,s}),s.removeDpl=((t,n)=>{n=n||e;for(let e of n)delete e.index;if(t){let e=new Set;return n.filter(n=>!e.has(n[t])&&e.add(n[t]))}let i=new Set(n.map(JSON.stringify));return s.res=Array.from(i).map(JSON.parse),s}),s.sum=(t=>(t=t||e,s.res=t.reduce((e,t)=>Object.keys(t).reduce((e,n)=>(e[n]=(e[n]||0)+ +t[n],e),e),{}),s)),s.sort=((t,n)=>{return n=n||e,s.res=n.sort((()=>(e,n)=>e[t]>n[t]?1:e[t]<n[t]?-1:0)()),s}),s.res=(()=>{if(t){let e=n.filter((e,n)=>("remove duplicates"===t.execute||t.columns||(e.index=n),t.child&&"insert"!==t.execute||"insert"===t.execute&&t.nest?e[t.child].some((e,n)=>t.query(e,n)):t.query(e,n)));if(t.child){for(const e of n)for(const n of e[t.child])"remove duplicates"!==t.execute&&(n.parent=e.index),i.push(n);r=i,i=i.filter((e,n)=>t.query(e,n))}return e}})(),s.child=i,t){switch(t.execute){case"update":let n=Object.keys(t.item)||{};s.res.forEach(i=>e.findIndex(e=>{if(e===i)for(const i of n)if(t.nest)for(const e of s.child)e[i]=t.item[i];else e[i]=t.item[i]}));break;case"delete":if(s.child.forEach(e=>r.splice(r.findIndex(t=>t===e),1)),t.nest){s.res.forEach(e=>e[t.child].findIndex(n=>{for(const i of s.child)n===i&&e[t.child].splice(e[t.child].findIndex(e=>e===i),1)})),s.res=e;break}s.res.forEach(t=>e.splice(e.findIndex(e=>e===t),1));break;case"insert":if(t.child)for(const n of s.res)"object"!=typeof n[t.child]&&(n[t.child]=[]),t.item.parent=n.index,e[n.index][t.child].push(t.item),r.push(t.item);else e.push(t.item)}if("select"!==t.execute&&(s.res=e,s.child=r),t.template){let e=s.res,n={};if(s.res||(e=s),t.nest&&(e=s.child),t.component){let i=(n,i)=>{n=n||e,i.innerHTML="";let r=document.createElement("section");if(r.classList.add("s-parent"),1===t.style.length){let e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href",t.style[0]),i.appendChild(e)}else{let e=document.createElement("style");e.textContent=t.style,i.appendChild(e)}for(const e of n){let n=document.createElement("article");n.classList.add("s-article"),n.innerHTML=t.template(e),r.appendChild(n)}return i.appendChild(r),i};class r extends HTMLElement{constructor(){super();const r=this.attachShadow({mode:t.mode||"open"});i(e,r);"closed"!==t.mode?(n=t.element).Select=(e=>t.find(r.querySelectorAll(e))):n.Select=(()=>console.log("mode is closed! to use Select method, Switch to the open Mode!")),t.handler&&t.handler(n,e,(e,t)=>{i(e,r),t&&t(r)})}}customElements.define(t.selector,r)}else{t.element.Html("").set();for(const n of e)t.element.Html(t.template(n)).append()}}}return t.callback&&t.callback(t.element,s),s}static HtmlEscape(e){const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;","`":"&#180;"},n=e=>t[e]||e;return(e=>e.replace(/[&<>"']/g,n))(e)}static BytesToSize(e){if("0"===e.toString())return"0 Byte";let t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}}
