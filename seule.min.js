class Seule{constructor(e){this.element="window"===e?[window]:"object"==typeof e?e:document.querySelectorAll(e),this.tags=this.element,this.tags.length&&(this.tags=this.element[0]),this.selector=e,this.check=!0}find(e){return new Seule("object"==typeof e?e:this.selector+" "+e)}children(e){let t=this.tags.children;return e?"last"===e.toString().toLowerCase()?new Seule(t[t.length-1]):"first"===e.toString().toLowerCase()?new Seule(t[0]):new Seule(t[e-1]):new Seule(t)}parent(){return new Seule(this.tags.parentElement)}each(e){if(null==this.element.length)e.call(this.element);else for(const t of this.element)e.call(t);return this}on(e,t){return this.each(function(){this.addEventListener(e,()=>t(new Seule(this),this),!1)})}click(e){return this.on("click",t=>e(t))}focus(e){return e?this.on("focus",t=>e(t)):(this.tags.focus(),this.tags)}blur(e){return e?this.on("blur",t=>e(t)):(this.tags.blur(),this.tags)}hold(e){let t=null,n="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0,i=n?"touchstart":"mousedown",o=n?"touchend":"mouseup",s=n?"touchmove":"mousemove",r=0,l=0,a=10,c=10;function u(e){h(e);let i=e.target,s=parseInt(i.getAttribute("data-long-press-delay")||"1500",10);t=function(e,t){if(!(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame&&window.mozCancelRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame))return window.setTimeout(e,t);let n=(new Date).getTime(),i={},o=function(){(new Date).getTime()-n>=t?e.call():i.value=requestAnimFrame(o)};return i.value=requestAnimFrame(o),i}(function(e){h();let t=n?e.touches[0].clientX:e.clientX,i=n?e.touches[0].clientY:e.clientY;this.dispatchEvent(new CustomEvent("long-press",{bubbles:!0,cancelable:!0,detail:{clientX:t,clientY:i}}))&&document.addEventListener(o,function e(t){document.removeEventListener(o,e,!0),function(e){e.stopImmediatePropagation(),e.preventDefault(),e.stopPropagation()}(t)},!0)}.bind(i,e),s)}function h(e){var n;(n=t)&&(window.cancelAnimationFrame?window.cancelAnimationFrame(n.value):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(n.value):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(n.value):window.mozCancelRequestAnimationFrame?window.mozCancelRequestAnimationFrame(n.value):window.oCancelRequestAnimationFrame?window.oCancelRequestAnimationFrame(n.value):window.msCancelRequestAnimationFrame?window.msCancelRequestAnimationFrame(n.value):clearTimeout(n)),t=null}return"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};let n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},window.CustomEvent.prototype=window.Event.prototype),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},document.addEventListener(o,h,!0),document.addEventListener(s,function(e){let t=Math.abs(r-e.clientX),n=Math.abs(l-e.clientY);(t>=a||n>=c)&&h()},!0),document.addEventListener("wheel",h,!0),document.addEventListener("scroll",h,!0),document.addEventListener(i,function(e){r=e.clientX,l=e.clientY,u(e)},!0),this.on("long-press",t=>e(t)),this}swipe(e,t){let n,i,o=this.element;return o[0].addEventListener("touchstart",function(e){n=e.touches[0].clientX,i=e.touches[0].clientY},!1),o[0].addEventListener("touchmove",function(o){if(!n||!i)return;let s=o.touches[0].clientX,r=o.touches[0].clientY,l=n-s,a=i-r;if(Math.abs(l)>Math.abs(a)){if(l>0){if("left"!==e)return!1;t(new Seule(this),this)}else if(l<0){if("right"!==e)return!1;t(new Seule(this),this)}}else if(a>0){if("top"!==e)return!1;t(new Seule(this),this)}else if(a<0){if("bottom"!==e)return!1;t(new Seule(this),this)}n=null,i=null},!1),this}hotKey(e,t){let n,i="",o={Arrow:"",Control:"ctrl"},s=e.replace(/\s/g,"");return this.each(function(){this.addEventListener("keydown",function(e){i=(i+=e.key).replace(/Arrow|Control/gi,function(e){return o[e]}),(n=i.toLowerCase().indexOf(s.toLowerCase()))>-1&&(t(new Seule(this),this),i=""),setInterval(()=>i="",5e3)},!0)})}emit(e){let t=document.querySelector(e.target);return this.on(e.on,function(){let n=new MouseEvent(e.event,{view:window,bubbles:!0,cancelable:!0});t.dispatchEvent(n)})}toggle(e){let t=!0;return this.on(e.event,function(n){if(!0===t)return e.handler(n),void(t=!1);e.callback(n),t=!0})}scroll(e){let t=new Seule(this.parent().selector);return e&&(t=new Seule(e)),"fixed"===t.getStyle("position").toLowerCase()?t.element[0].scrollTop=this.tags.offsetTop-10:window.scrollTo({top:this.tags.offsetTop}),this.tags}scrollPosition(e){return e?this.tags.pageXOffset||this.tags.scrollLeft:this.tags.pageYOffset||this.tags.scrollTop}width(e){return e?this.each(function(){this.style.width=e}):getComputedStyle(this.tags).width}height(e){return e?this.each(function(){this.style.height=e}):getComputedStyle(this.tags).height}addClass(e){return this.each(function(){this.classList.add(e)})}removeClass(e){return this.each(function(){this.classList.remove(e)})}toggleClass(e){return this.each(function(){this.classList.toggle(e)})}hasClass(e){if(this.tags.className.match("(?:^|\\s)"+e+"(?!\\S)"))return!0}style(e,t){return this.each(function(){this.style[e]=t})}css(e){return this.each(function(){this.setAttribute("style",Seule.objectToStyle(e))})}getStyle(e){return getComputedStyle(this.tags)[e]}classList(){let e=[];for(const t of this.tags.classList)e.push(t);return e}classListContains(e){return this[0].classList.contains(e)}show(){return this.each(function(){this.getAttribute("style").includes("display: none")?this.style.display="":this.style.display="inherit"})}hide(){return this.each(function(){this.style.display="none"})}visible(e){return this.each(function(){this.style.visibility=e?"hidden":"visible"})}isVisible(){return"hidden"!==this.tags.style.visibility}opacity(e){return this.each(function(){this.style.opacity=e})}anime(e){let t=Object.keys(e),n=this.tags,i={},o={},s={},r={},l={};for(const a of t){let t=e[a].delay||"0s",c=e[a].duration||"0.3s";if("type"!=a&&"direction"!=a){let u=getComputedStyle(n);i[a]=c+" "+t,o[a]=e[a].value||"inherit",r===l&&(r[a]=u[a]||"inherit"),s[a]=parseFloat(t.replace(/s/g,""))+parseFloat(c.replace(/s/g,""))}}o.transition=Seule.objectToStyle(i).replace(/:/g," ").replace(/;/g,", "),o["transition-timing-function"]=e.type||"ease",r.transition=o.transition,r["transition-timing-function"]=o["transition-timing-function"],r===l&&(l=r);let a=Object.values(s);return s=1e3*Math.max(...a),this.each(function(){let t,n=this,i=1,l=e.timeOut||100,a=2*parseInt(s+l)+100;function c(e,s){n.setAttribute("style",Seule.objectToStyle(o)),setTimeout(()=>n.setAttribute("style",Seule.objectToStyle(r)),parseInt(e)),s&&s<=++i&&clearInterval(t)}e.direction||e.loop?(c(s+l),t=setInterval(function(){e.time?c(s+l,e.time):c(s+l)},a),e.direction&&clearInterval(t)):n.setAttribute("style",Seule.objectToStyle(o))})}text(e){return void 0===e?this.tags.innerText:this.each(function(){this.innerText=e})}val(e){return void 0===e?this.tags.value:this.each(function(){this.value=e})}attr(e,t){return t?this.each(function(){this.setAttribute(e,t)}):this.tags.getAttribute(e)}attrRemove(e){return this.each(function(){this.removeAttribute(e)})}html(e){return void 0===e?this.tags.innerHTML:this.each(function(){this.innerHTML=e})}append(e,t){return this.each(function(){this.insertAdjacentHTML(Seule.hTmlplace("beforeend",t),e)})}insertHtml(e,t){return this.each(function(){this.insertAdjacentHTML(Seule.hTmlplace("afterend",t),e)})}static async http(e){let t=new FormData;if(e.form){let n=document.querySelector(e.form);t=new FormData(n),n.onsubmit=(async e=>e.preventDefault())}e.file&&("object"==typeof e.file?Seule.loop({obj:e.file,handler:function(e){let n;n="object"==typeof e?e:document.querySelector(e),t.append(n.name,n.files[0])}}):(e.file=document.querySelector(e.file),t.append(e.file.name,e.file.files[0]))),e.data&&Object.keys(e.data).forEach(n=>t.append(n,e.data[n]));let n=await fetch(e.url,{method:e.method||"get",body:t});return n.ok?e.blob?await n.blob():e.json?await n.json():await n.text():"HTTP-Error: "+n.status}static async post(e){return e.urls=e.url||"",e.datas=e.data||"",e.result=[],e.method="post","object"==typeof e.url?(Seule.loop({obj:e.urls,handler(t){e.url=t,Seule.http(e).then(function(t){e.result.push(t)})}}),e.result):"object"==typeof e.data?(Seule.loop({obj:e.datas,handler(t){e.data=t,Seule.http(e).then(function(t){e.result.push(t)})}}),e.result):await Seule.http(e)}static store(e){if(e.obj)window.localStorage.setItem(e.name,JSON.stringify(e.obj));else{if("get"===e.Execute)return JSON.parse(window.localStorage.getItem(name));"delete"===e.Execute&&window.localStorage.removeItem(name),"delete All"===e.Execute&&window.localStorage.clear()}return this}static loop(e){return"object"!=typeof e.obj?Seule.http({url:e.obj,json:!0,method:"get"}).then(function(t){e.obj=t,[].forEach.call(e.obj,e.handler)}):[].forEach.call(e.obj,e.handler),e}static hTmlplace(e,t){switch(!0){case"top"===t:e="afterbegin";break;case"before"===t:e="beforebegin";break;case null==t&&"afterend"===e:e="afterend";break;default:e="beforeend"}return e}static objectToUrlQuery(e){return("'"+Object.keys(e).map(t=>t+"="+e[t]).join("&")+"'").slice(1).slice(0,-1)}static objectToStyle(e){return Seule.objectToUrlQuery(e).replace(/&/g,";").replace(/=/g,":")}static audioPlay(e,t){let n=new Audio(e);return this.delay=t,setTimeout(function(){n.pause(),n.play()},t),n}static audioPauseIn(e,t){return setTimeout(function(){e.pause(),e.currentTime=0},t+this.delay),this}static increaseDate(e){let t=new Date(e.date),n=new Date(t.setMonth(t.getMonth()+parseInt(e.step))),i=n.getMonth()+1;if(e.prefix){if("day"===e.prefix.toLowerCase()){let t=new Date(e.date);return t.setDate(t.getDate()+parseInt(e.step)),t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2)}return(i=t.getFullYear()+1)+"-"+("0"+t.getMonth()).slice(-2)+"-"+("0"+t.getDate()).slice(-2)}return n.getFullYear()+"-"+("0"+i).slice(-2)+"-"+("0"+n.getDate()).slice(-2)}static ifDateBetween(e){let t=e.from.split(e.character||"/"),n=e.to.split(e.character||"/"),i=e.value.split(e.character||"/");return e.from=new Date(t[2],parseInt(t[1])-1,t[0]),e.to=new Date(n[2],parseInt(n[1])-1,n[0]),e.value=new Date(i[2],parseInt(i[1])-1,i[0]),e.value>e.from&&e.value<e.to?(e.handler&&e.handler(),!0):(e.callback&&e.callback(),!1)}static load(e){let t=document.querySelectorAll(e.selector);return Seule.http({url:e.url}).then(function(n){for(const e of t)e.innerHTML=n;e.handler(new Seule(e.selector),t)}),this}static setHtmlMethod(e){let t=document.querySelectorAll(e.selector+" *");return Seule.loop({obj:t,handler(t){if(t.getAttribute("@"+e.attr)){let n=t.getAttribute("@"+e.attr).split("{"),i="{"+n[1].slice(0,-1)+"}";i=i.replace(/[~']/g,'"').replace(/[~`]/g,'"'),i=JSON.parse(i),n[0]?t.addEventListener(n[0],()=>e.handler(i,new Seule(t),t),!1):e.handler(i,new Seule(t),t)}}}),e.element=new Seule(e.selector),e.e=t,this}static scrollTop(){return window.scrollTo({top:0,behavior:"smooth"}),this}static scrollBottom(){return window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),this}static orientation(){return"90"==screen.orientation.angle?"Horizontally":"Vertically"}static screen(e,t,n){let i=window.matchMedia(e),o=s(i);function s(e){return e.matches&&("function"==typeof t?t():"function"==typeof n&&n()),e}return i.addEventListener("change",s),o}static sceneHandler(e){return window.addEventListener("scroll",function(){!function(e){let t,n=document.querySelector(e.selector),i=e.unit||"percent",o=e.distance,s=window.innerHeight||document.documentElement.clientHeight,r=n.getBoundingClientRect().top,l=Math.round(r/s*100),a=Math.round(r);(t="percent"==i?l:a)<=o?e.handler():e.callback&&e.callback()}(e)},!1),this}static scene(e){let t=0;return Seule.sceneHandler({selector:e.selector||"body",distance:e.distance||0,unit:e.unit||"percent",handler:()=>{0===t&&(e.handler(),t=1)},callback:()=>{1===t&&e.callback&&(e.callback(),t=0)}}),this}static print(e){new Seule("body").append('<iframe class="seule--frame" name="sframe" style="position: fixed; bottom: -100%"></iframe>');let t=document.getElementsByClassName("seule--frame")[0],n=t.contentWindow?t.contentWindow:t.contentDocument.document?t.contentDocument.document:t.contentDocument;n.document.open(),n.document.write("<html><head><title>DIV Contents</title>"),n.document.write("</head><body>"),n.document.write('<link href="'+e.css+'" rel="stylesheet" type="text/css" />'),n.document.write(e.html),n.document.write("</body></html>"),n.document.close(),setTimeout(function(){window.frames.sframe.focus(),window.frames.sframe.print()},500)}static PDO(e){let t=[...e.obj],n=[],i=[],o={},s=t=>{t.map(function(t){let n=t;if("object"==typeof e.columns&&"replace"===e.action.toLowerCase()&&(n[e.columns[1]]=n[e.columns[0]],delete n[e.columns[0]]),"drop"===e.action.toLowerCase())for(const t of e.columns)delete n[t];if("add"===e.action.toLowerCase())for(const t of e.columns)n.hasOwnProperty(t)||(n[t]="");return n})},r=t=>{let n=[];return e.group=[...new Set(t.reduce((t,n)=>t.concat(n[e.columns]),[]))],Seule.loop({obj:e.group,handler(t,i){let o='{"'+e.columns+'":"'+t+'"}';n.push(JSON.parse(o))}}),n},l=t=>{if(e.columns){let n=new Set;return t.filter(t=>!n.has(t[e.columns])&&n.add(t[e.columns]))}let n=new Set(t.map(JSON.stringify));return Array.from(n).map(JSON.parse)},a=e=>e.reduce((e,t)=>Object.keys(t).reduce((e,n)=>(e[n]=(e[n]||0)+ +t[n],e),e),{}),c=t=>{return t.sort((()=>(t,n)=>t[e.columns]>n[e.columns]?1:t[e.columns]<n[e.columns]?-1:0)(e.columns))};switch(o.res=(()=>{let o=t.filter((t,n)=>("remove duplicates"===e.Execute||e.columns||(t.index=n),e.child&&"insert"!==e.Execute||"insert"===e.Execute&&e.nest?t[e.child].some((t,n)=>e.query(t,n)):e.query(t,n)));if(e.child){for(const i of t)for(const t of i[e.child])"remove duplicates"!==e.Execute&&(t.parent=i.index),n.push(t);i=n,n=n.filter((t,n)=>e.query(t,n))}return o})(),o.child=n,e.Execute){case"update":let u=Object.keys(e.item)||{};o.res.forEach(t=>e.obj.findIndex(n=>{if(n===t)for(const t of u)if(e.nest)for(const n of o.child)n[t]=e.item[t];else n[t]=e.item[t]}));break;case"delete":if(o.child.forEach(e=>i.splice(i.findIndex(t=>t===e),1)),e.nest){o.res.forEach(t=>t[e.child].findIndex(n=>{for(const i of o.child)n===i&&t[e.child].splice(t[e.child].findIndex(e=>e===i),1)})),o.res=e.obj;break}o.res.forEach(t=>e.obj.splice(e.obj.findIndex(e=>e===t),1));break;case"insert":if(e.child)for(const t of o.res)"object"!=typeof t[e.child]&&(t[e.child]=[]),e.item.parent=t.index,e.obj[t.index][e.child].push(e.item),i.push(e.item);else e.obj.push(e.item);break;case"alter":e.nest?s(o.child):s(o.res);break;case"group by":o=e.nest?r(o.child):r(o.res);break;case"sum":o=e.nest?a(o.child):a(o.res);break;case"remove duplicates":o=e.nest?l(o.child):l(o.res);break;case"order by":o=e.nest?c(o.child):c(o.res)}if("select"!==e.Execute&&(o.res=e.obj,o.child=i),"order by"!==e.Execute&&"sum"!==e.Execute&&"group by"!==e.Execute&&"remove duplicates"!==e.Execute||(delete o.child,delete o.res),e.handler&&e.handler(new Seule(e.selector),o),e.fetch){let t=new Seule(e.selector),n=o.res,i="";o.res||(n=o),e.nest&&(n=o.child);for(const t of n)i+=e.fetch(t);t.html(i)}return o}}