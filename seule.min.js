"use strict";class Seule{constructor(e,t,n,s){this.el=e,this.external=s,this.element="window"===e?[window]:"object"==typeof e?e:document.querySelectorAll(e),this.tags=this.element,this.tags.length&&(this.tags=this.element[0]),this.selector=e,this.root=t,this.children=!1,this.firstChild=!1;let i=this.children,r=this.firstChild;this.render=function(){let t=this.tags;customElements.define("seule-"+e.replace("#",""),class extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"closed"});if("object"==typeof n){let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",n[0]+".css"),e.appendChild(t)}else{let t=document.createElement("style");t.textContent=n,e.appendChild(t)}let s=t.cloneNode(!0);t.innerHTML="",e.appendChild(s),i=new Seule(e.children),r=i.element[1]}});let s=document.createElement("seule-"+e.replace("#",""));t.appendChild(s)},t&&"object"!=typeof t&&(this.render(),this.children=i,console.log("%cDon't try anything cute,\n%cDom is Protected! ðŸ˜¡","color: gray; font-size:15px;","color: red; font-size:38px;")),this.firstChild=r}Find(e){return this.root?(this.tags=this.firstChild.querySelectorAll(e),this.el=e,new Seule(this.tags,this.firstChild)):new Seule("object"==typeof e?e:this.el+" "+e)}Children(e){let t=this.tags.children;return e?"last"===e.toString().toLowerCase()?new Seule(t[t.length-1]):"first"===e.toString().toLowerCase()?new Seule(t[0]):new Seule(t[e-1]):new Seule(t)}Parent(){return new Seule(this.tags.parentElement)}Each(e){if(null==this.element.length)e.call(this.element);else for(const t of this.element)e.call(t);return this}On(e,t){return this.Each(function(){this.addEventListener(e,()=>t(new Seule(this),this),!1)})}Click(e){return this.On("click",t=>e(t)),this}Focus(e){return e?this.On("focus",t=>e(t)):this.tags.focus(),this}Blur(e){return e?this.On("blur",t=>e(t)):this.tags.blur(),this}Hold(e,t){return t=t||"1.5s",this.Each(function(){let n=!1,s="ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints,i=s?"touchstart":"mousedown",r=s?"touchend":"mouseup";this.addEventListener(i,function(s){n=!0,setTimeout(function(){n&&e(new Seule(s),s)},1e3*parseFloat(t.replace(/s/g,"")))}),this.addEventListener(r,function(){n=!1})})}Swipe(e,t){let n,s,i=this.element;return i[0].addEventListener("touchstart",function(e){n=e.touches[0].clientX,s=e.touches[0].clientY},!1),i[0].addEventListener("touchmove",function(i){if(n&&s){let r=i.touches[0].clientX,l=i.touches[0].clientY,o=n-r,a=s-l;if(Math.abs(o)>Math.abs(a)){if(0<o){if("left"!==e)return!1;t(new Seule(this),this)}else if(0>o){if("right"!==e)return!1;t(new Seule(this),this)}}else if(0<a){if("top"!==e)return!1;t(new Seule(this),this)}else if(0>a){if("bottom"!==e)return!1;t(new Seule(this),this)}n=null,s=null}},!1),this}HotKey(e,t){let n,s="",i={Arrow:"",Control:"ctrl"},r=e.replace(/\s/g,"");return this.Each(function(){this.addEventListener("keydown",function(e){s=(s+=e.key).replace(/Arrow|Control/gi,function(e){return i[e]}),-1<(n=s.toLowerCase().indexOf(r.toLowerCase()))&&(t(new Seule(this),this),s=""),setInterval(()=>s="",5e3)},!0)})}Copy(e,t){let n,s=t.split(":");n=this.root?this.root.querySelector(e):this.tags.closest("body").querySelector(e);for(let e of s)this.On(e.trimStart().trimEnd(),function(){let t=new MouseEvent(e.trimStart().trimEnd(),{view:window,bubbles:!0,cancelable:!0});n.dispatchEvent(t)});return this}Toggle(e,t){let n=!0;return this.On(e,function(e){return!0===n?(t.handler(e),void(n=!1)):(t.callback(e),void(n=!0))}),this}Scroll(e){let t=new Seule(this.Parent().selector);return e&&(t=new Seule(e)),"fixed"===t.GetStyle("position").toLowerCase()?t.element[0].scrollTop=this.tags.offsetTop-10:window.scrollTo({top:this.tags.offsetTop}),this}ScrollPosition(e){return e?this.tags.pageXOffset||this.tags.scrollLeft:this.tags.pageYOffset||this.tags.scrollTop}Delay(e,t){return this.Each(function(){setTimeout(()=>{e(new Seule(this))},t||1e3)})}AddClass(e){return this.Each(function(){this.classList.add(e)})}RemoveClass(e){return this.Each(function(){this.classList.remove(e)})}ToggleClass(e){return this.Each(function(){this.classList.toggle(e)})}HasClass(e){return!!this.tags.className.match("(?:^|\\s)"+e+"(?!\\S)")}Classes(e,t){return this.Each(function(){this.classList[e](t)})}ClassList(){let e=[];for(const t of this.tags.classList)e.push(t);return e}ClassListContains(e){return this.tags.classList.contains(e)}Style(e,t){return t?this.Each(function(){this.style[e]=t}):getComputedStyle(this.tags)[e]}Css(e){return this.Each(function(){this.setAttribute("style",Seule.objectToStyle(e))})}Show(){return this.Each(function(){"none"===getComputedStyle(this).display&&(this.style.display="inherit")})}Hide(){return this.Each(function(){this.style.display="none"})}Visible(e){return this.Each(function(){this.style.visibility=e?"hidden":"visible"})}IsVisible(){return"hidden"!==this.tags.style.visibility}Opacity(e){return this.Each(function(){this.style.opacity=e})}Anime(e){if(e){let t=Object.keys(e),n={},s={},i={},r={},l={};for(const o of t){"object"==typeof e[o]||"duration property direction loop time delay text".includes(o)||(e[o]={value:e[o]});let t=e[o].delay||"0s",a=e[o].duration||e.duration||"0.7s";if(!"duration property direction loop time delay text".includes(o)){let c=getComputedStyle(this.tags);n[o]=a+" "+t,s[o]=e[o].value||"inherit",r===l&&(r[o]=c[o]||"inherit"),i[o]=parseFloat(t.replace(/s/g,""))+parseFloat(a.replace(/s/g,""))}}s.transition=Seule.objectToStyle(n).replace(/:/g," ").replace(/;/g,", "),s["transition-timing-function"]=e.type||"ease",e.property&&(s["transition-property"]=e.property),e.loop||e.direction||(e.duration&&(s["transition-duration"]=e.duration),e.delay&&(s["transition-delay"]=e.delay)),r.transition=s.transition,r["transition-timing-function"]=s["transition-timing-function"],e.property&&(r["transition-property"]=s["transition-property"]),e.duration&&(r["transition-duration"]=s["transition-duration"]),e.delay&&(r["transition-delay"]=s["transition-delay"]),r===l&&(l=r);let o=Object.values(i);return i=1e3*Math.max(...o),this.Each(function(){function t(e,t){l.setAttribute("style",Seule.objectToStyle(s)),setTimeout(()=>{l.setAttribute("style",Seule.objectToStyle(r))},parseInt(e)),t&&(t<=++o&&clearInterval(n))}let n,l=this,o=1,a=100;(e.loop||e.direction)&&e.delay&&(a=1e3*parseFloat(e.delay.replace(/s/g,"")));let c=2*parseInt(i+a)+100;e.direction||e.loop?(t(i+a),n=setInterval(function(){e.time?t(i+a,e.time):t(i+a)},c),e.direction&&clearInterval(n)):l.setAttribute("style",Seule.objectToStyle(s))})}return this.Each(function(){this.style.transition="all ease 0.7s"})}Width(e){return e?this.Each(function(){this.style.width=e}):getComputedStyle(this.tags).width}Height(e){return e?this.Each(function(){this.style.height=e}):getComputedStyle(this.tags).height}Text(e){return void 0===e?this.tags.innerText:this.Each(function(){this.innerText=e})}Val(e){return void 0===e?this.tags.value:this.Each(function(){this.value=e})}Attr(e,t){return t?this.Each(function(){this.setAttribute(e,t)}):this.tags.getAttribute(e)}AttrRemove(e){return this.Each(function(){this.removeAttribute(e)})}Html(e){return void 0===e?this.tags.innerHTML:this.Each(function(){this.innerHTML=e})}Append(e,t){return this.Each(function(){this.insertAdjacentHTML(Seule.HTMLPLACE("beforeend",t),e)})}InsertHtml(e,t){return this.Each(function(){this.insertAdjacentHTML(Seule.HTMLPLACE("afterend",t),e)})}Root(e){let t=decodeURI(window.location.href).split("?"),n={},s=this;this.root&&this.external&&(s=new Seule(this.children.element[1]));let i=s.Html(),r=[];t=t[1].split("&"),e&&(e=e.split("&"));for(let n of t){if(e)for(let t of e){let e=t.split("="),s=n.split("=");e[0]===s[0]&&(n=t)}r.push(n+"")}for(let e of r)if(e.includes("=")){let t=e.split("=");for(n[t[0]]=t[1];i.includes("{{"+t[0]+"}}");)i=i.replace("{{"+t[0]+"}}","<seules class='str202109876"+t[0]+"'>"+t[1]+"</seules>")}s.Html(i);for(let e of r)if(e.includes("=")){let t=e.split("=");new Seule(".str202109876"+t[0]).Text(t[1])}return n}Component(e,t){let n=this.Find(e);return t.data&&!t.data.length&&(t.obj=[],t.obj.push(t.data),t.data=t.obj),Seule.PDO(t.data||[{}],{element:n,component:!0,mode:t.mode,style:t.style||"",execute:t.execute||!1,child:t.child||!1,columns:t.columns||!1,nest:t.nest||!1,item:t.item||!1,action:t.action||!1,selector:e,query:e=>t.query?t.query(e):e,template:e=>t.template(e)||"",handler(e,n,s){t.handler&&t.handler(e,n,s)}}),this}Emit(e,t){let n;return n=this.root?this.children.el[1]:this.tags,Seule.GETATTR(n,e,t),this}HtmlMethod(){let e=!1,t=this.tags;return this.root&&(t=e=this.firstChild),Seule.GETATTR(t,!1,!1,e),this}static async GET(e,t){let n=document,s=new FormData;if(t.parent&&(n=t.parent.children.element[1]),t.param={method:t.method||"get"},t.form){let e=n.querySelector(t.form);s=new FormData(e),e.onsubmit=(async e=>e.preventDefault())}t.file&&("object"==typeof t.file?Seule.LOOP({data:t.file,handler:function(e){let t;t="object"==typeof e?e:n.querySelector(e),s.append(t.name,t.files[0])}}):(t.file=n.querySelector(t.file),s.append(t.file.name,t.file.files[0]))),t.data&&Object.keys(t.data).forEach(e=>s.append(e,t.data[e])),"post"===t.method&&(t.param.body=s);let i=await fetch(e,t.param);return i.ok?t.blob?await i.blob():t.json?await i.json():await i.text():"HTTP-Error: "+i.status}static async POST(e){return e.urls=e.url||"",e.datas=e.data||"",e.result=[],e.method="post",e.exec=(t=>{Seule.LOOP({data:e[t+"s"],handler(n){e[t]=n,Seule.GET(e.url,e).then(function(t){e.result.push(t)})}})}),"object"==typeof e.url?(e.exec("url"),e.result):"object"==typeof e.data?(e.exec("data"),e.result):await Seule.GET(e.url,e)}static STORE(e,t){if(t.data)window.localStorage.setItem(e,JSON.stringify(t.data));else{if("get"===t.execute)return JSON.parse(window.localStorage.getItem(e));"delete"===t.execute&&window.localStorage.removeItem(e),"delete All"===t.execute&&window.localStorage.clear()}return this}static LOOP(e){return"object"==typeof e.data?[].forEach.call(e.data,e.handler):Seule.GET(e.data,{json:!0,method:"get"}).then(function(t){e.data=t,[].forEach.call(e.data,e.handler)}),e}static HTMLPLACE(e,t){switch(!0){case"top"===t:e="afterbegin";break;case"before"===t:e="beforebegin";break;case null==t&&"afterend"===e:e="afterend";break;default:e="beforeend"}return e}static objectToUrlQuery(e){return("'"+Object.keys(e).map(t=>t+"="+e[t]).join("&")+"'").slice(1).slice(0,-1)}static objectToStyle(e){return Seule.objectToUrlQuery(e).replace(/&/g,";").replace(/=/g,":")}static AUDIO(e){let t={Delay:0};return t.Element=new Audio(e),t.Src=e,t.Play=function(e){return t.Delay=1e3*e,setTimeout(function(){t.Element.pause(),t.Element.play()},t.Delay),this},t.Stop=function(e){return setTimeout(function(){t.Element.pause(),t.Element.currentTime=0},1e3*e),this},t.Pause=function(e){return setTimeout(function(){t.Element.pause()},1e3*e),this},t}static DATE(e){let t={Increase:function(n,s){let i=new Date(e),r=new Date(i.setMonth(i.getMonth()+parseInt(s))),l=r.getMonth()+1;if(n)if("day"===n.toLowerCase()){let n=new Date(e);n.setDate(n.getDate()+parseInt(s)),t.current=n.getFullYear()+"-"+("0"+(n.getMonth()+1)).slice(-2)+"-"+("0"+n.getDate()).slice(-2)}else l=i.getFullYear()+1,t.current=l+"-"+("0"+i.getMonth()).slice(-2)+"-"+("0"+i.getDate()).slice(-2);else t.current=r.getFullYear()+"-"+("0"+l).slice(-2)+"-"+("0"+r.getDate()).slice(-2);return t.res=t.current,this},BetWeen:function(e){let n=t.current||t.Increase("day",0).current,s=e.from.split(e.character||"-"),i=e.to.split(e.character||"-"),r=n.split(e.character||"-");return e.from=new Date(s[0],parseInt(s[1])-1,s[2]),e.to=new Date(i[0],parseInt(i[1])-1,i[2]),(n=new Date(r[0],parseInt(r[1])-1,r[2]))>e.from&&n<e.to?(e.handler&&e.handler(),t.res=!0,this):(e.callback&&e.callback(),t.res=!1,this)}};return t}static SCROLL(){return{Top:function(){return window.scrollTo({top:0,behavior:"smooth"}),this},Bottom:function(){return window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),this}}}static ORIENTATION(){return"90"==screen.orientation.angle?"Horizontally":"Vertically"}static SCREEN(e,t){function n(e){return e.matches&&("function"==typeof t.handler?t.handler():"function"==typeof t.callback&&t.callback()),e}let s=window.matchMedia(e),i=n(s);return s.addEventListener("change",n),i}static SCENEHANDLER(e){return window.addEventListener("scroll",function(){!function(e){let t,n=document.querySelector(e.selector),s=e.unit||"percent",i=e.distance,r=window.innerHeight||document.documentElement.clientHeight,l=n.getBoundingClientRect().top,o=Math.round(l/r*100),a=Math.round(l);(t="percent"==s?o:a)<=i?e.handler():e.callback&&e.callback()}(e)},!1),this}static SCENE(e){let t=0;return Seule.SCENEHANDLER({selector:e.selector||"body",distance:e.distance||0,unit:e.unit||"percent",handler:()=>{0===t&&(e.handler(),t=1)},callback:()=>{1===t&&e.callback&&(e.callback(),t=0)}}),this}static PRINT(e){let t=e.title||"";new Seule("body").Append('<iframe class="seule--frame" name="sframe" style="position: fixed; bottom: -100%"></iframe>');let n=document.getElementsByClassName("seule--frame")[0],s=n.contentWindow?n.contentWindow:n.contentDocument.document?n.contentDocument.document:n.contentDocument;s.document.open(),s.document.write("<html><head><title>"+t+"</title>"),s.document.write("</head><body>"),e.style&&s.document.write('<link href="'+e.style+'.css" rel="stylesheet" type="text/css" />'),s.document.write(e.template),s.document.write("</body></html>"),s.document.close(),setTimeout(function(){window.frames.sframe.focus(),window.frames.sframe.print()},500)}static PDO(e,t){t&&!t.query&&(t.query=(e=>e));let n=[...e],s=[],i=[],r={};if(r.alter=((t,n,s)=>(s=s||e,s.map(function(e){let s=e;if("object"==typeof n&&"replace"===t.toLowerCase()&&(s[n[1]]=s[n[0]],delete s[n[0]]),"drop"===t.toLowerCase())for(const e of n)delete s[e];if("add"===t.toLowerCase())for(const e of n)s.hasOwnProperty(e)||(s[e]="");return s}),r)),r.group=((t,n)=>{n=n||e;let s=[],i=[...new Set(n.reduce((e,n)=>e.concat(n[t]),[]))];return Seule.LOOP({data:i,handler(e){s.push(JSON.parse('{"'+t+'":"'+e+'"}'))}}),r.res=s,r}),r.removeDpl=((t,n)=>{n=n||e;for(let e of n)delete e.index;if(t){let e=new Set;return n.filter(n=>!e.has(n[t])&&e.add(n[t]))}let s=new Set(n.map(JSON.stringify));return r.res=Array.from(s).map(JSON.parse),r}),r.sum=(t=>(t=t||e,r.res=t.reduce((e,t)=>Object.keys(t).reduce((e,n)=>(e[n]=(e[n]||0)+ +t[n],e),e),{}),r)),r.sort=((t,n)=>(n=n||e,r.res=n.sort((()=>(e,n)=>e[t]>n[t]?1:e[t]<n[t]?-1:0)()),r)),r.res=(()=>{if(t){let e=n.filter((e,n)=>("remove duplicates"===t.execute||t.columns||(e.index=n),t.child&&"insert"!==t.execute||"insert"===t.execute&&t.nest?e[t.child].some((e,n)=>t.query(e,n)):t.query(e,n)));if(t.child){for(const e of n)for(const n of e[t.child])"remove duplicates"!==t.execute&&(n.parent=e.index),s.push(n);i=s,s=s.filter((e,n)=>t.query(e,n))}return e}})(),r.child=s,t){switch(t.execute){case"update":let n=Object.keys(t.item)||{};r.res.forEach(s=>e.findIndex(e=>{if(e===s)for(const s of n)if(t.nest)for(const e of r.child)e[s]=t.item[s];else e[s]=t.item[s]}));break;case"delete":if(r.child.forEach(e=>i.splice(i.findIndex(t=>t===e),1)),t.nest){r.res.forEach(e=>e[t.child].findIndex(n=>{for(const s of r.child)n===s&&e[t.child].splice(e[t.child].findIndex(e=>e===s),1)})),r.res=e;break}r.res.forEach(t=>e.splice(e.findIndex(e=>e===t),1));break;case"insert":if(t.child)for(const n of r.res)"object"!=typeof n[t.child]&&(n[t.child]=[]),t.item.parent=n.index,e[n.index][t.child].push(t.item),i.push(t.item);else e.push(t.item);break;case"alter":t.nest?r.alter(t.action,t.columns,r.child):r.alter(t.action,t.columns,r.res);break;case"group by":r=t.nest?r.group(t.columns,r.child):r.group(t.columns,r.res);break;case"sum":r=t.nest?r.sum(r.child):r.sum(r.res);break;case"remove duplicates":r=t.nest?r.removeDpl(t.columns||!1,r.child):r.removeDpl(t.columns||!1,r.res);break;case"order by":r=t.nest?r.sort(t.columns||!1,r.child):r.sort(t.columns||!1,r.res)}if("select"!==t.execute&&(r.res=e,r.child=i),("order by"===t.execute||"sum"===t.execute||"group by"===t.execute||"remove duplicates"===t.execute)&&(delete r.child,delete r.res),t.template){let e=r.res,n=[],s="",i={};if(r.res||(e=r),t.nest&&(e=r.child),"sum"===t.execute&&(n.push(e),e=n),t.component){let n=(n,s,i,r)=>{n=n||e,s.innerHTML="";for(const n of e){let e=document.createElement("s-bind");if(e.innerHTML=t.template(n),Seule.GETATTR(e,i,r,e),s.appendChild(e),1===t.style.length){let e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href",t.style[0]+".css"),s.appendChild(e)}else{let e=document.createElement("style");e.textContent=t.style,s.appendChild(e)}}};class s extends HTMLElement{constructor(){super();const s=this.attachShadow({mode:t.mode||"open"});n(s);"closed"===t.mode?i.Select=(()=>console.log("mode is closed! to use find method, Switch to the open Mode!")):(i=t.element).Select=(e=>new Seule(s.querySelectorAll(e))),t.handler&&t.handler(i,e,(t,i,r)=>{n(t=t||e,s,i,r)})}}customElements.define(t.selector,s)}else{let n=new Seule(t.selector),i=i=>{i=i||e,s="";for(const e of i)s+=t.template(e);n.Html(s)};i(e),t.handler&&t.handler(new Seule(t.selector),e,i)}}}return r}static GETATTR(e,t,n,s){let i,r=e.querySelectorAll("*"),l=0,o={},a={};for(let c of r){o={};let r=new Seule(c,s),u=(e,s)=>{if("copy text val show hide visible opacity width height attr style classes anime css".includes(s.toLowerCase()))if("Copy Attr Style Classes".includes(s)){let t=Object.keys(e);r[s](t[0],e[t[0]])}else r[s](e);else t&&n&&n(e,r)};c.getAttributeNames().includes("@find")&&(r=e.querySelectorAll(c.getAttribute("@find")),r=new Seule(r,s));for(let e of c.getAttributeNames())if(e.includes("@")){let t=c.getAttribute(e),n=e.replace("@","").replace(/\w/,e=>e.toUpperCase());t.includes("($")?(i=(i="{"+(t=t.split("($"))[1].slice(0,-2)+"}").replace(/[~']/g,'"').replace(/[~`]/g,'"'),i="text val show hide visible opacity width height".includes(n.toLowerCase())?t[1].slice(0,-1):JSON.parse(i),t[0]?(a[l]=["; "+n+"$"+JSON.stringify(i)],o[t[0]]+=a[l],l++):"@find"!==e&&u(i,n)):"Find"!==n&&u(t,n)}let h=Object.keys(o);for(let e of h){let t=o[e].replace("undefined;","").split(";"),i=new Seule(c,s);n=(()=>{for(let e of t){let t=e.split("$");"Find"!==t[0].trimStart()&&u(JSON.parse(t[1]),t[0].trimStart())}}),"hold"===e&&i.Hold(n),i.On(e,n)}}return this}}
