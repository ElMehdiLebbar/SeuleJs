"use strict";class Seule{constructor(a,b,c,d){this.el=a,this.external=d,this.element="window"===a?[window]:"object"==typeof a?a:document.querySelectorAll(a),this.tags=this.element,this.tags.length&&(this.tags=this.element[0]),this.selector=a,this.root=b,this.children=!1,this.firstChild=!1;let e=this.children,f=this.firstChild;this.render=function(){let b=this.tags;class d extends HTMLElement{constructor(){super();const a=this.attachShadow({mode:"closed"});if("object"==typeof c){let b=document.createElement("link");b.setAttribute("rel","stylesheet"),b.setAttribute("href",c[0]+".css"),a.appendChild(b)}else{let b=document.createElement("style");b.textContent=c,a.appendChild(b)}let d=b.cloneNode(!0);b.innerHTML="",a.appendChild(d),e=new Seule(a.children),f=e.element[1]}}customElements.define("seule-"+a.replace("#",""),d);let g=document.createElement("seule-"+a.replace("#",""));b.appendChild(g)},b&&"object"!=typeof b&&(this.render(),this.children=e,console.log("%cDon't try anything cute,\n%cDom is Protected! \uD83D\uDE21","color: gray; font-size:15px;","color: red; font-size:38px;")),this.firstChild=f}Find(a){return this.root?(this.tags=this.firstChild.querySelectorAll(a),this.el=a,new Seule(this.tags,this.firstChild)):"object"==typeof a?new Seule(a):new Seule(this.el+" "+a)}Children(a){let b=this.tags.children;return a?"last"===a.toString().toLowerCase()?new Seule(b[b.length-1]):"first"===a.toString().toLowerCase()?new Seule(b[0]):new Seule(b[a-1]):new Seule(b)}Parent(){return new Seule(this.tags.parentElement)}Each(a){if(null==this.element.length)a.call(this.element);else for(const b of this.element)a.call(b);return this}On(a,b){return this.Each(function(){this.addEventListener(a,()=>b(new Seule(this),this),!1)})}Click(a){return this.On("click",b=>a(b)),this}Focus(a){return a?this.On("focus",b=>a(b)):this.tags.focus(),this}Blur(a){return a?this.On("blur",b=>a(b)):this.tags.blur(),this}Hold(a,b){return b=b||"1.5s",this.Each(function(){let c=!1,d="ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints,e=d?"touchstart":"mousedown",f=d?"touchend":"mouseup";this.addEventListener(e,function(d){c=!0,setTimeout(function(){c&&a(new Seule(d),d)},1e3*parseFloat(b.replace(/s/g,"")))}),this.addEventListener(f,function(){c=!1})})}Swipe(a,b){function c(c){if(d&&e){let f=c.touches[0].clientX,g=c.touches[0].clientY,h=d-f,i=e-g;if(Math.abs(h)>Math.abs(i)){if(0<h){if("left"===a)b(new Seule(this),this);else return!1;}else if(0>h)if("right"===a)b(new Seule(this),this);else return!1;}else if(0<i){if("top"===a)b(new Seule(this),this);else return!1;}else if(0>i)if("bottom"===a)b(new Seule(this),this);else return!1;d=null,e=null}}let d,e,f=this.element;return f[0].addEventListener("touchstart",function(a){d=a.touches[0].clientX,e=a.touches[0].clientY},!1),f[0].addEventListener("touchmove",c,!1),this}HotKey(a,b){let c,d="",e={Arrow:"",Control:"ctrl"},f=a.replace(/\s/g,"");return this.Each(function(){this.addEventListener("keydown",function(a){d+=a.key,d=d.replace(/Arrow|Control/gi,function(a){return e[a]}),c=d.toLowerCase().indexOf(f.toLowerCase()),-1<c&&(b(new Seule(this),this),d=""),setInterval(()=>d="",5e3)},!0)})}Copy(a,b){let c,d=b.split(":");c=this.root?this.root.querySelector(a):this.tags.closest("body").querySelector(a);for(let e of d)this.On(e.trimStart().trimEnd(),function(){let a=new MouseEvent(e.trimStart().trimEnd(),{view:window,bubbles:!0,cancelable:!0});for(let b of c)b.dispatchEvent(a)});return this}Toggle(a,b){let c=!0;return this.On(a,function(a){return!0===c?(b.handler(a),void(c=!1)):void(b.callback(a),c=!0)}),this}Scroll(a){let b=new Seule(this.Parent().selector);return a&&(b=new Seule(a)),"fixed"===b.GetStyle("position").toLowerCase()?b.element[0].scrollTop=this.tags.offsetTop-10:window.scrollTo({top:this.tags.offsetTop}),this}ScrollPosition(a){return a?this.tags.pageXOffset||this.tags.scrollLeft:this.tags.pageYOffset||this.tags.scrollTop}Delay(a,b){return this.Each(function(){setTimeout(()=>{a(new Seule(this))},b||1e3)})}AddClass(a){return this.Each(function(){this.classList.add(a)})}RemoveClass(a){return this.Each(function(){this.classList.remove(a)})}ToggleClass(a){return this.Each(function(){this.classList.toggle(a)})}HasClass(a){return!!this.tags.className.match("(?:^|\\s)"+a+"(?!\\S)")}Classes(a,b){return this.Each(function(){this.classList[a](b)})}ClassList(){let a=[];for(const b of this.tags.classList)a.push(b);return a}ClassListContains(a){return this.tags.classList.contains(a)}Style(a,b){return b?this.Each(function(){this.style[a]=b}):getComputedStyle(this.tags)[a]}Css(a){return this.Each(function(){this.setAttribute("style",Seule.objectToStyle(a))})}Show(){return this.Each(function(){let a=getComputedStyle(this).display;"none"===a&&(this.style.display="inherit")})}Hide(){return this.Each(function(){this.style.display="none"})}Visible(a){return this.Each(function(){this.style.visibility=a?"hidden":"visible"})}IsVisible(){return"hidden"!==this.tags.style.visibility}Opacity(a){return this.Each(function(){this.style.opacity=a})}Anime(a){if(a){let b=Object.keys(a),c={},d={},e={},f={},g={};for(const h of b){"object"==typeof a[h]||"duration property direction loop time delay text".includes(h)||(a[h]={value:a[h]});let b=a[h].delay||"0s",i=a[h].duration||a.duration||"0.7s";if(!"duration property direction loop time delay text".includes(h)){let j=getComputedStyle(this.tags);c[h]=i+" "+b,d[h]=a[h].value||"inherit",f===g&&(f[h]=j[h]||"inherit"),e[h]=parseFloat(b.replace(/s/g,""))+parseFloat(i.replace(/s/g,""))}}d.transition=Seule.objectToStyle(c).replace(/:/g," ").replace(/;/g,", "),d["transition-timing-function"]=a.type||"ease",a.property&&(d["transition-property"]=a.property),a.loop||a.direction||(a.duration&&(d["transition-duration"]=a.duration),a.delay&&(d["transition-delay"]=a.delay)),f.transition=d.transition,f["transition-timing-function"]=d["transition-timing-function"],a.property&&(f["transition-property"]=d["transition-property"]),a.duration&&(f["transition-duration"]=d["transition-duration"]),a.delay&&(f["transition-delay"]=d["transition-delay"]),f===g&&(g=f);let h=Object.values(e);return e=1e3*Math.max(...h),this.Each(function(){function b(a,b){g.setAttribute("style",Seule.objectToStyle(d)),setTimeout(()=>{g.setAttribute("style",Seule.objectToStyle(f))},parseInt(a)),b&&(h++,b<=h&&clearInterval(c))}let c,g=this,h=1,i=100;(a.loop||a.direction)&&a.delay&&(i=1e3*parseFloat(a.delay.replace(/s/g,"")));let j=2*parseInt(e+i)+100;a.direction||a.loop?(b(e+i),c=setInterval(function(){a.time?b(e+i,a.time):b(e+i)},j),a.direction&&clearInterval(c)):g.setAttribute("style",Seule.objectToStyle(d))})}return this.Each(function(){this.style.transition="all ease 0.7s"})}Width(a){return a?this.Each(function(){this.style.width=a}):getComputedStyle(this.tags).width}Height(a){return a?this.Each(function(){this.style.height=a}):getComputedStyle(this.tags).height}Text(a){return"undefined"==typeof a?this.tags.innerText:this.Each(function(){this.innerText=a})}Val(a){return"undefined"==typeof a?this.tags.value:this.Each(function(){this.value=a})}Attr(a,b){return b?this.Each(function(){this.setAttribute(a,b)}):this.tags.getAttribute(a)}AttrRemove(a){return this.Each(function(){this.removeAttribute(a)})}Html(a){return"undefined"==typeof a?this.tags.innerHTML:this.Each(function(){this.innerHTML=a})}Append(a,b){return this.Each(function(){this.insertAdjacentHTML(Seule.HTMLPLACE("beforeend",b),a)})}InsertHtml(a,b){return this.Each(function(){this.insertAdjacentHTML(Seule.HTMLPLACE("afterend",b),a)})}Root(a){let b=decodeURI(window.location.href).split("?"),c={},d=this;this.root&&this.external&&(d=new Seule(this.children.element[1]));let e=d.Html(),f=[];b=b[1].split("&"),a&&(a=a.split("&"));for(let c of b){if(a)for(let b of a){let a=b.split("="),d=c.split("=");a[0]===d[0]&&(c=b)}f.push(c+"")}for(let b of f)if(b.includes("=")){let a=b.split("=");for(c[a[0]]=a[1];e.includes("{{"+a[0]+"}}");)e=e.replace("{{"+a[0]+"}}","<seules class='str202109876"+a[0]+"'>"+a[1]+"</seules>")}d.Html(e);for(let b of f)if(b.includes("=")){let a=b.split("="),c=new Seule(".str202109876"+a[0]);c.Text(a[1])}return c}Component(a,b){let c=this.Find(a);return b.data&&!b.data.length&&(b.obj=[],b.obj.push(b.data),b.data=b.obj),Seule.PDO(b.data||[{}],{element:c,component:!0,mode:b.mode,style:b.style||"",execute:b.execute||!1,child:b.child||!1,columns:b.columns||!1,nest:b.nest||!1,item:b.item||!1,action:b.action||!1,selector:a,query(a){return b.query?b.query(a):a},template(a){return b.template(a)||""},handler(a,c,d){b.handler&&b.handler(a,c,d)}}),this}Emit(a,b){let c;return c=this.root?this.children.el[1]:this.tags,Seule.GETATTR(c,a,b),this}HtmlMethod(){let a=!1,b=this.tags;return this.root&&(b=a=this.firstChild),Seule.GETATTR(b,!1,!1,a),this}static async GET(a,b){let c=document,d=new FormData;if(b.parent&&(c=b.parent.children.element[1]),b.param={method:b.method||"get"},b.form){let a=c.querySelector(b.form);d=new FormData(a),a.onsubmit=async a=>a.preventDefault()}b.file&&("object"==typeof b.file?Seule.LOOP({data:b.file,handler:function(a){let b;b="object"==typeof a?a:c.querySelector(a),d.append(b.name,b.files[0])}}):(b.file=c.querySelector(b.file),d.append(b.file.name,b.file.files[0]))),b.data&&Object.keys(b.data).forEach(a=>d.append(a,b.data[a])),"post"===b.method&&(b.param.body=d);let e=await fetch(a,b.param);return e.ok?b.blob?await e.blob():b.json?await e.json():await e.text():"HTTP-Error: "+e.status}static async POST(a){return a.urls=a.url||"",a.datas=a.data||"",a.result=[],a.method="post",a.exec=b=>{Seule.LOOP({data:a[b+"s"],handler(c){a[b]=c,Seule.GET(a.url,a).then(function(b){a.result.push(b)})}})},"object"==typeof a.url?(a.exec("url"),a.result):"object"==typeof a.data?(a.exec("data"),a.result):await Seule.GET(a.url,a)}static STORE(a,b){if(b.data)window.localStorage.setItem(a,JSON.stringify(b.data));else{if("get"===b.execute)return JSON.parse(window.localStorage.getItem(a));"delete"===b.execute&&window.localStorage.removeItem(a),"delete All"===b.execute&&window.localStorage.clear()}return this}static LOOP(a){return"object"==typeof a.data?[].forEach.call(a.data,a.handler):Seule.GET(a.data,{json:!0,method:"get"}).then(function(b){a.data=b,[].forEach.call(a.data,a.handler)}),a}static HTMLPLACE(a,b){switch(!0){case"top"===b:a="afterbegin";break;case"before"===b:a="beforebegin";break;case null==b&&"afterend"===a:a="afterend";break;default:a="beforeend";}return a}static objectToUrlQuery(a){let b=Object.keys(a).map(b=>b+"="+a[b]).join("&");return("'"+b+"'").slice(1).slice(0,-1)}static objectToStyle(a){return Seule.objectToUrlQuery(a).replace(/&/g,";").replace(/=/g,":")}static AUDIO(a){let b={};return b.Delay=0,b.Element=new Audio(a),b.Src=a,b.Play=function(a){return b.Delay=1e3*a,setTimeout(function(){b.Element.pause(),b.Element.play()},b.Delay),this},b.Stop=function(a){return setTimeout(function(){b.Element.pause(),b.Element.currentTime=0},1e3*a),this},b.Pause=function(a){return setTimeout(function(){b.Element.pause()},1e3*a),this},b}static DATE(a){let b={};return b.Increase=function(c,d){let e=new Date(a),f=new Date(e.setMonth(e.getMonth()+parseInt(d))),g=f.getMonth()+1;if(!c)b.current=f.getFullYear()+"-"+("0"+g).slice(-2)+"-"+("0"+f.getDate()).slice(-2);else if("day"===c.toLowerCase()){let c=new Date(a);c.setDate(c.getDate()+parseInt(d)),b.current=c.getFullYear()+"-"+("0"+(c.getMonth()+1)).slice(-2)+"-"+("0"+c.getDate()).slice(-2)}else g=e.getFullYear()+1,b.current=g+"-"+("0"+e.getMonth()).slice(-2)+"-"+("0"+e.getDate()).slice(-2);return b.res=b.current,this},b.BetWeen=function(a){let d=b.current||b.Increase("day",0).current,e=a.from.split(a.character||"-"),f=a.to.split(a.character||"-"),g=d.split(a.character||"-");return(a.from=new Date(e[0],parseInt(e[1])-1,e[2]),a.to=new Date(f[0],parseInt(f[1])-1,f[2]),d=new Date(g[0],parseInt(g[1])-1,g[2]),d>a.from&&d<a.to)?(a.handler&&a.handler(),b.res=!0,this):(a.callback&&a.callback(),b.res=!1,this)},b}static SCROLL(){return{Top:function(){return window.scrollTo({top:0,behavior:"smooth"}),this},Bottom:function(){return window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),this}}}static ORIENTATION(){return"90"==screen.orientation.angle?"Horizontally":"Vertically"}static SCREEN(a,b){function c(a){return a.matches&&("function"==typeof b.handler?b.handler():"function"==typeof b.callback&&b.callback()),a}let d=window.matchMedia(a),e=c(d);return d.addEventListener("change",c),e}static SCENEHANDLER(a){function b(a){let b,c=document.querySelector(a.selector),d=a.unit||"percent",e=a.distance,f=window.innerHeight||document.documentElement.clientHeight,g=c.getBoundingClientRect().top,h=Math.round(100*(g/f)),i=Math.round(g);b="percent"==d?h:i,b<=e?a.handler():a.callback&&a.callback()}return window.addEventListener("scroll",function(){b(a)},!1),this}static SCENE(a){let b=0;return Seule.SCENEHANDLER({selector:a.selector||"body",distance:a.distance||0,unit:a.unit||"percent",handler:()=>{0===b&&(a.handler(),b=1)},callback:()=>{1===b&&a.callback&&(a.callback(),b=0)}}),this}static PRINT(a){let b=a.title||"",c=new Seule("body");c.Append("<iframe class=\"seule--frame\" name=\"sframe\" style=\"position: fixed; bottom: -100%\"></iframe>");let d=document.getElementsByClassName("seule--frame")[0],e=d.contentWindow?d.contentWindow:d.contentDocument.document?d.contentDocument.document:d.contentDocument;e.document.open(),e.document.write("<html><head><title>"+b+"</title>"),e.document.write("</head><body>"),a.style&&e.document.write("<link href=\""+a.style+".css\" rel=\"stylesheet\" type=\"text/css\" />"),e.document.write(a.template),e.document.write("</body></html>"),e.document.close(),setTimeout(function(){window.frames.sframe.focus(),window.frames.sframe.print()},500)}static PDO(a,b){b&&!b.query&&(b.query=a=>a);let c=[...a],d=[],e=[],g={},h=()=>{if(b){let a=c.filter((a,c)=>("remove duplicates"===b.execute||b.columns||(a.index=c),b.child&&"insert"!==b.execute||"insert"===b.execute&&b.nest?a[b.child].some((a,c)=>b.query(a,c)):b.query(a,c)));if(b.child){for(const a of c)for(const c of a[b.child])"remove duplicates"!==b.execute&&(c.parent=a.index),d.push(c);e=d,d=d.filter((a,c)=>b.query(a,c))}return a}};if(g.alter=(b,d,e)=>(e=e||a,e.map(function(a){let e=a;if("object"==typeof d&&"replace"===b.toLowerCase()&&(e[d[1]]=e[d[0]],delete e[d[0]]),"drop"===b.toLowerCase())for(const a of d)delete e[a];if("add"===b.toLowerCase())for(const a of d)e.hasOwnProperty(a)||(e[a]="");return e}),g),g.group=(b,c)=>{c=c||a;let d=[],e=[...new Set(c.reduce((c,d)=>c.concat(d[b]),[]))];return Seule.LOOP({data:e,handler(a){d.push(JSON.parse("{\""+b+"\":\""+a+"\"}"))}}),g.res=d,g},g.removeDpl=(b,c)=>{c=c||a;for(let a of c)delete a.index;if(b){let a=new Set;return c.filter(c=>!a.has(c[b])&&a.add(c[b]))}let d=new Set(c.map(JSON.stringify));return g.res=Array.from(d).map(JSON.parse),g},g.sum=b=>(b=b||a,g.res=b.reduce((a,b)=>Object.keys(b).reduce((a,c)=>(a[c]=(a[c]||0)+ +b[c],a),a),{}),g),g.sort=(c,d)=>{return d=d||a,g.res=d.sort((()=>(d,a)=>d[c]>a[c]?1:d[c]<a[c]?-1:0)(c)),g},g.res=h(),g.child=d,b){switch(b.execute){case"update":let c=Object.keys(b.item)||{};g.res.forEach(d=>a.findIndex(a=>{if(a===d)for(const d of c)if(b.nest)for(const a of g.child)a[d]=b.item[d];else a[d]=b.item[d]}));break;case"delete":if(g.child.forEach(a=>e.splice(e.findIndex(b=>b===a),1)),b.nest){g.res.forEach(a=>a[b.child].findIndex(c=>{for(const d of g.child)c===d&&a[b.child].splice(a[b.child].findIndex(a=>a===d),1)})),g.res=a;break}g.res.forEach(b=>a.splice(a.findIndex(a=>a===b),1));break;case"insert":if(b.child)for(const c of g.res)"object"!=typeof c[b.child]&&(c[b.child]=[]),b.item.parent=c.index,a[c.index][b.child].push(b.item),e.push(b.item);else a.push(b.item);break;case"alter":b.nest?g.alter(b.action,b.columns,g.child):g.alter(b.action,b.columns,g.res);break;case"group by":g=b.nest?g.group(b.columns,g.child):g.group(b.columns,g.res);break;case"sum":g=b.nest?g.sum(g.child):g.sum(g.res);break;case"remove duplicates":g=b.nest?g.removeDpl(b.columns||!1,g.child):g.removeDpl(b.columns||!1,g.res);break;case"order by":g=b.nest?g.sort(b.columns||!1,g.child):g.sort(b.columns||!1,g.res);}if("select"!==b.execute&&(g.res=a,g.child=e),("order by"===b.execute||"sum"===b.execute||"group by"===b.execute||"remove duplicates"===b.execute)&&(delete g.child,delete g.res),b.template){let a=g.res,c=[],d="",e={};if(g.res||(a=g),b.nest&&(a=g.child),"sum"===b.execute&&(c.push(a),a=c),b.component){let c=(c,d,e,f)=>{c=c||a,d.innerHTML="";for(const g of a){let a=document.createElement("s-bind");if(a.innerHTML=b.template(g),Seule.GETATTR(a,e,f,a),d.appendChild(a),1===b.style.length){let a=document.createElement("link");a.setAttribute("rel","stylesheet"),a.setAttribute("href",b.style[0]+".css"),d.appendChild(a)}else{let a=document.createElement("style");a.textContent=b.style,d.appendChild(a)}}};class d extends HTMLElement{constructor(){super();const d=this.attachShadow({mode:b.mode||"open"});c(d);let f=(b,e,f)=>{b=b||a,c(b,d,e,f)};"closed"===b.mode?e.Select=()=>console.log("mode is closed! to use find method, Switch to the open Mode!"):(e=b.element,e.Select=a=>new Seule(d.querySelectorAll(a))),b.handler&&b.handler(e,a,f)}}customElements.define(b.selector,d)}else{let c=new Seule(b.selector),e=e=>{e=e||a,d="";for(const a of e)d+=b.template(a);c.Html(d)};e(a),b.handler&&b.handler(new Seule(b.selector),a,e)}}}return g}static GETATTR(a,b,c,d){let f,g=a.querySelectorAll("*"),h=0,j={},k={};for(let i of g){j={};let e=new Seule(i,d),g=(a,d)=>{if(!"copy text val show hide visible opacity width height attr style classes anime css".includes(d.toLowerCase()))b&&c&&c(a,e);else if("Copy Attr Style Classes".includes(d)){let b=Object.keys(a);e[d](b[0],a[b[0]])}else e[d](a)};i.getAttributeNames().includes("@find")&&(e=a.querySelectorAll(i.getAttribute("@find")),e=new Seule(e,d));for(let b of i.getAttributeNames())if(b.includes("@")){let a=i.getAttribute(b),c=b.replace("@","").replace(/\w/,a=>a.toUpperCase());a.includes("($")?(a=a.split("($"),f="{"+a[1].slice(0,-2)+"}",f=f.replace(/[~']/g,"\"").replace(/[~`]/g,"\""),f="text val show hide visible opacity width height".includes(c.toLowerCase())?a[1].slice(0,-2):JSON.parse(f),a[0]?(k[h]=["; "+c+"$"+JSON.stringify(f)],j[a[0]]+=k[h],h++):"@find"!==b&&g(f,c)):"Find"!==c&&g(a,c)}let l=Object.keys(j);for(let a of l){let b=j[a].replace("undefined;","").split(";"),e=new Seule(i,d);c=()=>{for(let c of b){let b=c.split("$");"Find"!==b[0].trimStart()&&g(JSON.parse(b[1]),b[0].trimStart())}},"hold"===a&&e.Hold(c),e.On(a,c)}}return this}}
